{"version":3,"file":"page-2.js","sources":["../src/js/01-searchapp.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreBtn = document.getElementById('load-more');\n\nconst API_KEY = '45947467-1fb23e21d26a094164d331d1f';\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  query = document.getElementById('query').value.trim();\n\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search term!',\n    });\n    return;\n  }\n  clearGallery();\n  page = 1;\n  loadMoreBtn.classList.add('hidden');\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n    totalHits = data.totalHits;\n\n    hideLoader();\n\n    if (data.hits.length === 0) {\n      iziToast.info({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    displayImages(data.hits);\n\n    if (data.hits.length < totalHits) {\n      loadMoreBtn.classList.remove('hidden');\n    }\n  } catch (error) {\n    handleError();\n  }\n});\n\nasync function fetchImages(query, page) {\n  const URL = `https://pixabay.com/api/?key=${API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=40`;\n  const response = await axios.get(URL);\n  return response.data;\n}\n\nfunction displayImages(images) {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    images\n      .map(\n        img => `\n        <a href=\"${img.largeImageURL}\" class=\"gallery-item\">\n          <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" />\n          <div class=\"info\">\n            <p>Likes: ${img.likes}</p>\n            <p>Views: ${img.views}</p>\n            <p>Comments: ${img.comments}</p>\n            <p>Downloads: ${img.downloads}</p>\n          </div>\n        </a>`\n      )\n      .join('')\n  );\n\n  refreshLightbox();\n}\n\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n    displayImages(data.hits);\n\n    if (page * 40 >= totalHits) {\n      loadMoreBtn.classList.add('hidden');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n    scrollToNextBatch();\n  } catch (error) {\n    handleError();\n  } finally {\n    hideLoader();\n  }\n});\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\nfunction refreshLightbox() {\n  const lightbox = new SimpleLightbox('.gallery-item', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  lightbox.refresh();\n}\n\nfunction scrollToNextBatch() {\n  const { height: cardHeight } =\n    gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\nfunction handleError() {\n  iziToast.error({\n    title: 'Error',\n    message: 'Something went wrong. Please try again later.',\n  });\n  hideLoader();\n}\n"],"names":["form","gallery","loader","loadMoreBtn","API_KEY","query","page","totalHits","e","iziToast","clearGallery","showLoader","data","fetchImages","hideLoader","displayImages","handleError","URL","axios","images","img","refreshLightbox","scrollToNextBatch","SimpleLightbox","cardHeight"],"mappings":"sJAMA,MAAMA,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAS,SAAS,eAAe,QAAQ,EACzCC,EAAc,SAAS,eAAe,WAAW,EAEjDC,EAAU,qCAEhB,IAAIC,EAAQ,GACRC,EAAO,EACPC,EAAY,EAEhBP,EAAK,iBAAiB,SAAU,MAAMQ,GAAK,CAIzC,GAHAA,EAAE,eAAc,EAChBH,EAAQ,SAAS,eAAe,OAAO,EAAE,MAAM,OAE3C,CAACA,EAAO,CACVI,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6BACf,CAAK,EACD,MACD,CACDC,IACAJ,EAAO,EACPH,EAAY,UAAU,IAAI,QAAQ,EAClCQ,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYR,EAAOC,CAAI,EAK1C,GAJAC,EAAYK,EAAK,UAEjBE,IAEIF,EAAK,KAAK,SAAW,EAAG,CAC1BH,EAAS,KAAK,CACZ,QACE,0EACV,CAAO,EACD,MACD,CAEDM,EAAcH,EAAK,IAAI,EAEnBA,EAAK,KAAK,OAASL,GACrBJ,EAAY,UAAU,OAAO,QAAQ,CAExC,MAAe,CACda,GACD,CACH,CAAC,EAED,eAAeH,EAAYR,EAAOC,EAAM,CACtC,MAAMW,EAAM,gCAAgCb,CAAO,MAAM,mBACvDC,CACJ,CAAG,iEAAiEC,CAAI,eAEtE,OADiB,MAAMY,EAAM,IAAID,CAAG,GACpB,IAClB,CAEA,SAASF,EAAcI,EAAQ,CAC7BlB,EAAQ,mBACN,YACAkB,EACG,IACCC,GAAO;AAAA,mBACIA,EAAI,aAAa;AAAA,sBACdA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA,wBAEhCA,EAAI,KAAK;AAAA,wBACTA,EAAI,KAAK;AAAA,2BACNA,EAAI,QAAQ;AAAA,4BACXA,EAAI,SAAS;AAAA;AAAA,aAGlC,EACA,KAAK,EAAE,CACd,EAEEC,GACF,CAEAlB,EAAY,iBAAiB,QAAS,SAAY,CAChDG,GAAQ,EACRK,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAYR,EAAOC,CAAI,EAC1CS,EAAcH,EAAK,IAAI,EAEnBN,EAAO,IAAMC,IACfJ,EAAY,UAAU,IAAI,QAAQ,EAClCM,EAAS,KAAK,CACZ,QAAS,4DACjB,CAAO,GAGHa,GACD,MAAe,CACdN,GACJ,QAAY,CACRF,GACD,CACH,CAAC,EAED,SAASJ,GAAe,CACtBT,EAAQ,UAAY,EACtB,CAEA,SAASU,GAAa,CACpBT,EAAO,UAAU,OAAO,QAAQ,CAClC,CAEA,SAASY,GAAa,CACpBZ,EAAO,UAAU,IAAI,QAAQ,CAC/B,CAEA,SAASmB,GAAkB,CACR,IAAIE,EAAe,gBAAiB,CACnD,aAAc,MACd,aAAc,GAClB,CAAG,EACQ,QAAO,CAClB,CAEA,SAASD,GAAoB,CAC3B,KAAM,CAAE,OAAQE,CAAY,EAC1BvB,EAAQ,kBAAkB,wBAC5B,OAAO,SAAS,CACd,IAAKuB,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CACA,SAASR,GAAc,CACrBP,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACb,CAAG,EACDK,GACF"}